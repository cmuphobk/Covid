# COVID-19
Целью данной работы является описание основных проблемы связанных с идентификацией COVID-19. Попытаться повторить выводы существующих статей на тему диагностирования СOVID-19 с применением метода машинного обучения. Вынести предположения по оптимизации существующих решений для идентификации. Построить план по развитию, существующих и выработанного в ходе работы решения. Назначение решения: Потенциальное решение на основе CXR или CT и их анализе с помощью ИИ может помочь медработникам быстрее идентифицировать COVID-19 и облегчить правильное использование ресурсов.

# Сбор данных и разработка
Небольшой набор данных - это самая большая слабость этого исследования, их очень мало в открытом доступе. Если изображений случаев с известными миру ранее типами пневмонии достаточно для построения хорошего набора данных, то с COVID, нашлось всего несколько ресурсов.
Набор данных для обучения и валидации состоит из 6121 изображения из них 199 - изображения с COVID-19 и 4337 изображений других форм пневмонии. 
Данные собраны из проверенных источников: 
Kaggle - система организации конкурсов по исследованию данных, а также социальная сеть специалистов по обработке данных и машинному обучению - URL: https://data.mendeley.com/datasets/rscbjbr9sj/2; 
Инициатива доктора компьютерных наук - Joseph Paul Cohen PhD. Попытался собрать данные со всех именитых источников и представить в открытом доступе через GitHub - URL: https://github.com/ieee8023/covid-chestxray-dataset.

# Обучение и тестирование модели
Обучение модели машинного обучения осуществлено на основе фреймворка CreateML от Apple и апробировано по средствам тестирования модели на снимках случаев COVID-19 не входящих в исходный набор данных - URL: https://radiopaedia.org/playlists/25890?lang=gb.

# Процесс исследования
Первая тренировка модели была осуществлена на структуре данных [«COVID-19», «No Finding», «ARDS», «SARS», «Pneumocystis», «Streptococcus», «Klebsiella», «Chlamydophila», «E.Coli», «Legionella»]. Каждая папка описывает характерный для нее случай пневмонии. Результаты тренировки и валидация модели представлены в таблице 1. Количество изображений в первоначальной выборке составляло 256. По результату валидации точность модели была достигнута 99%. Валидация происходила на 20% данных из исходных данных.
Вторая тренировка модели была осуществлена на структуре папок [«COVID-19», «No Finding», «others»]. В данной структуре все случаи пневмонии отдельные от COVID-19 были выделены в отдельную выборку. Гипотеза: выделить в модели отдельно, характерные признаки COVID-19 от остальных типов заболеваний вызывающих пневмонию. Точность сгенерированной модели упала до 93%. 
Финальное тестирование было проведено на большем количестве данных с большим количеством тестов, количество изображений для тренировки составляло 6121 изображение из них 199 - изображения с COVID-19 и 4337 изображений других форм пневмонии. Точность модели понизилась до 92% (обучение представлено в таблице 2), но и выборка увеличилось на несоизмеримо большие цифры, с большим количеством данных для валидации. Проводя анализ матрицы ошибок (таблица 3), видно что для 199 случаев с COVID-19 модель идентифицировала 135 случаев с COVID-19 и 62 с другими формами пневмонии и всего 2 ошибки можно назвать фатальными - нейронная сеть не дифференцировала заболевание вовсе. Для случаев без заболеваний 1359 - изображений были классифицированы успешно. И 226 - ошибочно. Для случаев с другими формами пневмоний 152 случая были классифицированы как - без болезни. Точность и полнота представлены в таблице 4.

# Заключение
На основании данной работы и исследований осуществленных ранее, очевидно что результаты (точности моделей) достаточно высоки, несмотря не небольшое количество данных для тренировок и количество тренировочных итераций. Но важно отметить, что этого не достаточно для применения выработанных моделей на практике. Но данных результатов достаточно для продолжения исследования по заданной теме и есть вероятность что выработанные результаты, смогут побудить медицинское сообщество рассматривать CXR и CT изображения в сочетании с методами машинного обучения, как потенциальный метод диагностики COVID-19 до тех пор, пока более быстрые методы диагностики не станут широко распространенными. В дальнейшем развитии решения предполагается: обучение на существующем наборе данных с большим количеством тренировочных итераций; использование различных архитектур для обнаружения наиболее оптимальной для заданной задачи и достижения большей точности модели; увеличение набора данных; разработка мобильного приложения с использованием машинного зрения для идентификации COVID-19 в режиме реального времени с использованием камеры мобильного устройства. Исходники проекта доступны в open source.

# Приложения
|Итерация обучения|Прошедшее время|Точность модели|
|-----------------|---------------|---------------|
|0	              |1.063014	      |0.708544	      |
|4	              |3.497627       |0.873713	      |
|9	              |5.914812	      |0.922725	      |

Таблица 1. Статистика обучения стартовой модели

|Итерация обучения|Прошедшее время|Точность модели|
|-----------------|---------------|---------------|
|0	              |0.065913	      |0.777344	      |
|4	              |0.230118       |0.777344	      |
|9	              |0.332947	      |0.882812	      |
|24	              |0.636141	      |0.992188	      |

Таблица 2. Статистика обучения модели с измененной структурой данных

|True/Prediction  |COVID-19       |No Finding     |others         |
|-----------------|---------------|---------------|---------------|
|COVID-19	        |135	          |2      	      |62             |
|No Finding       |4              |1359   	      |222            |
|others           |31     	      |152    	      |4154.          |

Таблица 3. Матрица ошибок (Confusion matrix)

|Класс            |Precision(%)   |Recall(%)      |
|-----------------|---------------|---------------|
|COVID-19         |79.41	        |67.84	        |
|No Finding       |89.82          |85.74          |
|others           |93.60	        |95.78	        |

Таблица 4. Точность/Полнота финального построения модели (Precision/Recall)

